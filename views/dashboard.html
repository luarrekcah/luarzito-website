<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Luarzito Dashboard</title>
    <link
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      rel="stylesheet"
      type="text/css"
    />
  </head>

  <body>
    <div id="display_result"></div>

    <a
      href="https://discord.com/api/oauth2/authorize?client_id=743841329334845530&redirect_uri=https%3A%2F%2Fluarzito.glitch.me%2Fdashboard&response_type=code&scope=identify%20guilds"
    >
      Login</a
    >
    <script>
      window.onload = () => {
        const code = location.href.substring(
          location.href.indexOf("code") + 5,
          location.href.length
        );

        if (location.href.indexOf("code") > -1) {
          const req = new XMLHttpRequest();
          var text = "";
          var obj = JSON.parse(text);
          console.log("esse é o responde do req: " + text);
          console.log("esse é o obj: " + obj);
          req.open("POST", "https://luarzito.glitch.me/dashboard");
          req.send(code);
          req.onload = () => {
            document.getElementById(
              "display_result"
            ).innerText = `Seu nome é ${obj}`;
          };
          console.log(req);
        }
      };
    </script>
    <script src="js/dashboard.js"></script>
  </body>
</html>
